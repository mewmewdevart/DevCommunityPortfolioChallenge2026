@import "tailwindcss";
@import "../../../styles/globals.css";

.crt-shutdown {
    @apply fixed inset-0 z-[9999] pointer-events-none;
    display: none;
}

.crt-shutdown.active {
    display: block;
}

.crt-shutdown__fill {
    @apply absolute inset-0 bg-white opacity-0;
    animation: crt-flash 0.1s ease-out forwards;
}

/* The black overlay that collapses */
.crt-shutdown__overlay {
    @apply absolute inset-0 bg-black;
    animation: crt-turn-off 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
    animation-delay: 0.1s;
    /* Start fully transparent/open so we can see the content before it closes */
    transform: scale(1, 1);
    opacity: 0;
}

/* 
   We actually want to mask the content, not draw black on top.
   But simpler approach for "turn off":
   
   Draw a BLACK container that starts "open" via clip-path or transform is tricky if we want to see underlying content.
   
   Better approach:
   The "content" is visible. We overlay a "curtain" that closes.
   
   TV Turn Off:
   1. Flash white (optional).
   2. Screen content squashes vertically to a line.
   3. Line squashes horizontally to a dot.
   4. Fade to black.
   
   To simulate this without complex html scanning:
   We can just animate a massive black border that closes in? 
   Or clip-path on the root element?
   
   Let's try the "Black overlay with a hole" approach using borders?
   No, let's use clip-path on the app container? That's invasive.
   
   Alternative: 
   Animate a black div that starts scales Y=0 (invisible line) -> Y=1?
   No, we want the *content* to shrink.
   
   "Simulate ... content compresses" -> this implies transforming the view.
   
   If we can't easily transform the whole page, we can fake it by drawing black bars moving in.
*/

.crt-shutdown__top {
    @apply absolute top-0 left-0 right-0 bg-(--dark-800);
    height: 50vh;
    transform: translateUnsafeY(-100%);
    /* Start off-screen */
    animation: shut-vertical 0.4s ease-in forwards;
    animation-delay: 0.1s;
}

.crt-shutdown__bottom {
    @apply absolute bottom-0 left-0 right-0 bg-(--dark-800);
    height: 50vh;
    transform: translateY(100%);
    /* Start off-screen */
    animation: shut-vertical 0.4s ease-in forwards;
    animation-delay: 0.1s;
}

.crt-shutdown__left {
    @apply absolute top-0 bottom-0 left-0 bg-(--dark-800);
    width: 50vw;
    transform: translateX(-100%);
    animation: shut-horizontal 0.4s ease-out forwards;
    animation-delay: 0.5s;
    /* Wait for vertical to finish */
}

.crt-shutdown__right {
    @apply absolute top-0 bottom-0 right-0 bg-(--dark-800);
    width: 50vw;
    transform: translateX(100%);
    animation: shut-horizontal 0.4s ease-out forwards;
    animation-delay: 0.5s;
}

/* 
   Revised Animation approach for "CRT Turn Off":
   We essentially want to preserve the "light" in the middle and close the darkness around it.
*/

@keyframes crt-flash {
    0% {
        opacity: 0;
    }

    50% {
        opacity: 0.8;
    }

    100% {
        opacity: 0;
    }
}

@keyframes shut-vertical {
    0% {
        transform: translateY(-100%);
    }

    /* For top */
    /* Handled by specific classes usually, but let's do customized */
}

/* 
   ACTUAL IMPLEMENTATION: 
   Use a single element with a "hole" via scale? 
   No, sticking to the classic: 
   1. Flash
   2. Background becomes black (but content visible?) - No.
   
   Let's do the "Beam" effect:
   - A container that is bright white/content color.
   - We scale it down?
   
   Simpler visual trick:
   Animate `mask-image` or `clip-path` on the whole screen?
   
   Since we are an overlay, we can just animate TWO black divs closing in vertically,
   then TWO black divs closing in horizontally.
*/

.crt-shutter-y {
    @apply absolute left-0 right-0 bg-(--dark-800) z-10;
    height: 50vh;
}

.crt-shutter-x {
    @apply absolute top-0 bottom-0 bg-(--dark-800) z-20;
    width: 50vw;
}

.crt-shutter-y-top {
    top: 0;
    transform: translateY(-100%);
    animation: shut-y 0.3s ease-in forwards 0.1s;
}

.crt-shutter-y-bottom {
    bottom: 0;
    transform: translateY(100%);
    animation: shut-y 0.3s ease-in forwards 0.1s;
}

.crt-shutter-x {
    @apply absolute top-0 bottom-0 bg-[#050510] z-20;
    width: 50vw;
}

.crt-shutter-x-left {
    left: 0;
    transform: translateX(-100%);
    animation: shut-x 0.2s ease-out forwards 0.4s;
}

.crt-shutter-x-right {
    right: 0;
    transform: translateX(100%);
    animation: shut-x 0.2s ease-out forwards 0.4s;
}

.crt-white-bar {
    @apply absolute top-1/2 left-0 right-0 h-1 bg-white z-30 opacity-0;
    transform: translateY(-50%);
    animation: white-bar-flash 0.4s linear forwards 0.3s;
}

@keyframes shut-y {
    to {
        transform: translateY(0);
    }
}

@keyframes shut-x {
    to {
        transform: translateX(0);
    }
}

@keyframes white-bar-flash {
    0% {
        opacity: 0;
        transform: translateY(-50%) scaleX(1);
    }

    10% {
        opacity: 1;
    }

    80% {
        opacity: 1;
        transform: translateY(-50%) scaleX(0.02);
    }

    100% {
        opacity: 0;
        transform: translateY(-50%) scaleX(0);
    }
}