import{r as i,j as a}from"./vendor-CGXhCyq3.js";import{W as I}from"./WinButton--HS0O22h.js";import{M as X}from"./minus-1uO7_Sla.js";import{I as Y}from"./game-BD-K9wUi.js";import"./i18n-CjG_VPcn.js";const L="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M18%202h-2v2h-2v2h-2v2h-2v2H8v2H6v2H4v2H2v6h6v-2h2v-2h2v-2h2v-2h2v-2h2v-2h2V8h2V6h-2V4h-2V2zm0%208h-2v2h-2v2h-2v2h-2v2H8v-2H6v-2h2v-2h2v-2h2V8h2V6h2v2h2v2zM6%2016H4v4h4v-2H6v-2z'%20fill='currentColor'/%3e%3c/svg%3e",q="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M16%202v4h6v2h-2v14H4V8H2V6h6V2h8zm-2%202h-4v2h4V4zm0%204H6v12h12V8h-4zm-5%202h2v8H9v-8zm6%200h-2v8h2v-8z'%20fill='currentColor'/%3e%3c/svg%3e",F="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M2%203h20v18H2V3zm18%2016V7H4v12h16z'%20fill='currentColor'/%3e%3c/svg%3e",$="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M17%203H7v2H5v2H3v10h2v2h2v2h10v-2h2v-2h2V7h-2V5h-2V3zm0%202v2h2v10h-2v2H7v-2H5V7h2V5h10z'%20fill='currentColor'/%3e%3c/svg%3e",O=()=>{const r=i.useRef(null),w=i.useRef(null),[l,V]=i.useState("#120B19"),[h,k]=i.useState("#dde6e0"),[v,N]=i.useState("pencil"),[d,R]=i.useState(1),[m,y]=i.useState(!1),[f,b]=i.useState(null),[x,C]=i.useState(null),u=i.useRef({color:l,secondaryColor:h,tool:v,lineWidth:d,isDrawing:m,startPos:f,snapshot:x});i.useEffect(()=>{u.current={color:l,secondaryColor:h,tool:v,lineWidth:d,isDrawing:m,startPos:f,snapshot:x}},[l,h,v,d,m,f,x]),i.useEffect(()=>{const e=r.current,n=w.current;if(!(!e||!n)&&(e.width===0||e.height===0)){e.width=Math.max(n.clientWidth,800),e.height=Math.max(n.clientHeight,400);const t=e.getContext("2d",{willReadFrequently:!0});t&&(t.fillStyle="#dde6e0",t.fillRect(0,0,e.width,e.height),t.lineCap="round",t.lineJoin="round")}},[]);const M=(e,n)=>{const t=r.current;if(!t)return{x:0,y:0};const o=t.getBoundingClientRect();return{x:e-o.left,y:n-o.top}},P=i.useCallback((e,n)=>{const t=r.current,o=t?.getContext("2d",{willReadFrequently:!0}),s=u.current;if(!t||!o)return;const c=M(e,n);b(c),y(!0),C(o.getImageData(0,0,t.width,t.height)),o.beginPath(),o.moveTo(c.x,c.y),o.lineWidth=s.lineWidth,o.strokeStyle=s.tool==="eraser"?s.secondaryColor:s.color,(s.tool==="pencil"||s.tool==="eraser")&&(o.lineTo(c.x,c.y),o.stroke())},[]),p=i.useCallback((e,n)=>{const t=u.current;if(!t.isDrawing||!t.startPos)return;const o=r.current,s=o?.getContext("2d",{willReadFrequently:!0});if(!o||!s)return;const c=M(e,n);if(t.tool==="pencil"||t.tool==="eraser")s.lineTo(c.x,c.y),s.stroke();else if(t.snapshot&&s.putImageData(t.snapshot,0,0),s.beginPath(),s.lineWidth=t.lineWidth,s.strokeStyle=t.color,t.tool==="line")s.moveTo(t.startPos.x,t.startPos.y),s.lineTo(c.x,c.y),s.stroke();else if(t.tool==="rect")s.strokeRect(t.startPos.x,t.startPos.y,c.x-t.startPos.x,c.y-t.startPos.y);else if(t.tool==="circle"){const H=Math.abs(c.x-t.startPos.x)/2,j=Math.abs(c.y-t.startPos.y)/2,W=Math.min(c.x,t.startPos.x)+H,B=Math.min(c.y,t.startPos.y)+j;s.ellipse(W,B,H,j,0,0,2*Math.PI),s.stroke()}},[]),g=i.useCallback(()=>{u.current.isDrawing&&(y(!1),b(null),C(null),r.current?.getContext("2d")?.closePath())},[]);i.useEffect(()=>{const e=r.current;if(!e)return;const n=t=>{t.preventDefault();const o=t.touches[0];p(o.clientX,o.clientY)};return e.addEventListener("touchmove",n,{passive:!1}),()=>{e.removeEventListener("touchmove",n)}},[p]);const S=e=>P(e.clientX,e.clientY),z=e=>p(e.clientX,e.clientY),D=e=>{const n=e.touches[0];P(n.clientX,n.clientY)},T=[{id:"pencil",icon:L},{id:"eraser",icon:q},{id:"line",icon:X},{id:"rect",icon:F},{id:"circle",icon:$}],E=["#120b19","#421e42","#4e3161","#5b5280","#6074ab","#6b9acf","#8bbde6","#aae0f3","#70a18f","#87c293","#b2dba0","#637c8f","#b4bebe","#dde6e0","#612447","#753a6a","#bd7182","#dfb6ae","#d18b79","#dbac8c","#e6cfa1","#faffe0"];return a.jsxs("div",{className:"paint-container",children:[a.jsxs("div",{className:"paint-body",children:[a.jsxs("div",{className:"paint-toolbar",children:[T.map(e=>a.jsx(I,{active:v===e.id,onClick:()=>N(e.id),className:"paint-tool-btn",children:a.jsx(Y,{icon:e.icon,size:16})},e.id)),a.jsx("div",{className:"paint-linewidth",children:[1,2,4].map(e=>a.jsx("div",{onClick:()=>R(e),className:`paint-linewidth-btn ${d===e?"active":""}`,children:a.jsx("div",{className:"paint-linewidth-inner",style:{height:`${e}px`}})},e))})]}),a.jsx("div",{ref:w,className:"paint-canvas-container",children:a.jsx("div",{className:"paint-canvas-wrapper",children:a.jsx("canvas",{ref:r,onMouseDown:S,onMouseMove:z,onMouseUp:g,onMouseLeave:g,onTouchStart:D,onTouchEnd:g,className:"paint-canvas",style:{touchAction:"none"}})})})]}),a.jsxs("div",{className:"paint-footer",children:[a.jsxs("div",{className:"paint-current-colors",children:[a.jsx("div",{className:"secondary-color",style:{backgroundColor:h}}),a.jsx("div",{className:"primary-color",style:{backgroundColor:l}})]}),a.jsx("div",{className:"paint-color-grid",children:E.map(e=>a.jsx("div",{className:"paint-color",style:{backgroundColor:e},onClick:()=>V(e),onContextMenu:n=>{n.preventDefault(),k(e)}},e))})]})]})};export{O as Paint};
