import{r as A,R as z,j as s}from"./vendor-CGXhCyq3.js";import{u as F,I as b}from"./game-BD-K9wUi.js";import{u as B,a as S}from"./index-CXS4LzyZ.js";import{W as M}from"./WinButton--HS0O22h.js";import{i as P}from"./file-alt-2Rtj3xTs.js";import"./i18n-CjG_VPcn.js";const L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAoCAYAAAC8cqlMAAAAAXNSR0IArs4c6QAAAPRJREFUWIXtmCEOAkEMRWcIDhQKTkKQqwgWiwDHAbjAHAAOsA4EFkvArNxwAjyKA+DB0y8adsI2P32y2ZnMS9NOZ2NoiUFv9P6Ozabr+Ot+ncYnMoKLWINGJC7mSQSPJxlDxdmE56sWsWF/olqLmgJNRlzEGjQiXRREhV2llWrDIu1FDBX2tXqovkMN4HwpxfloMuIi1qARiblv7NxoGwBNRlzEGjQi8Ga/HTb/P0kIYbzcidh9W6rW0mTERaxBIwLf7GhM1o7xuUHPAgRNRlzEGjQisNgR1hsATUZcxBo0InCMR6A/4EWSDaAtaDLiItagEfkA5h0005tipb0AAAAASUVORK5CYII=",O="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M11%2020h2V8h2V6h-2V4h-2v2H9v2h2v12zM7%2010V8h2v2H7zm0%200v2H5v-2h2zm10%200V8h-2v2h2zm0%200v2h2v-2h-2z'%20fill='currentColor'/%3e%3c/svg%3e",T=({folderId:R="desktop",windowId:p})=>{const{openWindow:E,getAppById:_,updateWindowTitle:x}=B(),{getItemsInFolder:y,getItem:h,deleteItem:D}=S(),{t:n,language:g}=F(),[m,I]=A.useState(R),[f,a]=A.useState(null),o=h(m),v=y(m),u=z.useMemo(()=>{const e={},t=[];v.forEach(l=>{if(l.type==="file"&&l.content&&typeof l.content!="string"&&"itemBaseId"in l.content&&l.content.itemBaseId){const i=l.content.itemBaseId;e[i]||(e[i]=[]),e[i].push(l)}else t.push(l)});const r=Object.values(e).map(l=>{const i=c=>c.replace("-","").toLowerCase(),W=i(g),N=l.find(c=>{const d=c.content.itemLanguage;return d&&i(d)===W});if(N)return N;const j=l.find(c=>{const d=c.content.itemLanguage;return d&&i(d)==="en"});return j||l[0]});return[...t,...r]},[v,g]);A.useEffect(()=>{!p||!o||x(p,o.name)},[m,p,o,x]);const k=e=>{const t=h(e);if(t){if(t.type==="folder")I(t.id),a(null);else if(t.type==="file"&&t.appId){const r=_(t.appId);r&&E(r,{content:t.content,title:t.name})}}},w=()=>{o?.parentId&&(I(o.parentId),a(null))},C=()=>{f&&(D(f),a(null))};return s.jsxs("section",{className:"file-explorer",tabIndex:-1,onKeyDown:e=>{e.key==="Delete"&&C()},onClick:()=>a(null),"aria-label":n("file_explorer")||"File Explorer",children:[s.jsxs("header",{className:"file-explorer-toolbar",children:[s.jsxs("span",{className:"file-explorer-address",children:[n("address_label")," ",o?.name||n("computer_root")]}),s.jsx(M,{onClick:w,disabled:!o?.parentId,className:"file-explorer-up-btn",title:n("ie_back"),style:{opacity:o?.parentId?1:.5},children:s.jsx(b,{icon:O,size:12})})]}),s.jsxs("div",{className:"file-explorer-grid",role:"list","aria-label":n("files_list")||"Files list",children:[u.length===0&&s.jsx("div",{className:"file-explorer-empty",children:n("folder_empty")}),u.map(e=>{const t=f===e.id;return s.jsxs("button",{type:"button",className:`file-item ${t?"file-item-selected":""}`,onClick:r=>{r.stopPropagation(),a(e.id)},onDoubleClick:r=>{r.stopPropagation(),k(e.id)},role:"listitem","aria-selected":t,children:[s.jsx("div",{className:"file-item-icon",children:e.type==="folder"?s.jsx("img",{src:L,alt:n("alt_file_explorer_folder"),className:"file-explorer_action-icon "}):s.jsx(b,{icon:P,size:32,className:"file-item-icon__svg file-item-icon__svg--file",alt:n("alt_file_explorer_file")})}),s.jsx("span",{className:"file-item-name",children:e.name})]},e.id)})]}),s.jsxs("footer",{className:"file-explorer-status",children:[u.length," ",n("objects_count")]})]})};export{T as FileExplorer};
