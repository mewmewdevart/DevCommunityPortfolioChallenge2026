import{r as o,j as e,R as Z}from"./vendor-CGXhCyq3.js";import{u as Q,L as Y,a as $,f as ee,i as te,A as H}from"./index-OybC14L-.js";import{u as T,c as G,I as z}from"./game-CeCUci3n.js";import{W as B}from"./WinButton-AkImxujQ.js";import{i as ne}from"./close-JBw0jS_e.js";import{ShutdownScreen as se}from"./ShutdownScreen-CKAwRccP.js";import{i as oe}from"./file-alt-2Rtj3xTs.js";import"./i18n-CjG_VPcn.js";const ie=()=>{const{t}=T(),[s,d]=o.useState(new Date);return o.useEffect(()=>{const u=setInterval(()=>d(new Date),1e3);return()=>clearInterval(u)},[]),e.jsx("div",{className:"clock","aria-label":t("system_clock"),role:"timer",children:s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})},re=()=>e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"volume-control__icon",children:[e.jsx("path",{d:"M3 9V15H7L12 20V4L7 9H3Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),e.jsx("path",{d:"M15.5 8.5C16.5 9.5 17 10.5 17 12C17 13.5 16.5 14.5 15.5 15.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M19 5C21 7 22 9.5 22 12C22 14.5 21 17 19 19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),ae=()=>{const{volume:t,setVolume:s}=G(),{t:d}=T(),[u,l]=o.useState(!1),r=o.useRef(null),A=o.useRef(null),_=()=>l(!u);return o.useEffect(()=>{const v=f=>{r.current&&!r.current.contains(f.target)&&A.current&&!A.current.contains(f.target)&&l(!1)};return u&&document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[u]),e.jsxs("div",{className:"volume-control",children:[u&&e.jsx("div",{className:"volume-control__popup",ref:r,children:e.jsx("div",{className:"volume-control__slider-wrapper",children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:t,onChange:v=>s(parseFloat(v.target.value)),className:"volume-control__slider",orient:"vertical","aria-label":d("volume_control")})})}),e.jsx("button",{ref:A,onClick:_,className:"volume-control__btn",title:d("volume"),"aria-label":d("volume"),"aria-haspopup":"true","aria-expanded":u,children:e.jsx(re,{})})]})},le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAAyCAYAAAD4FkP1AAAAAXNSR0IArs4c6QAAAMdJREFUaIHt2rENgkAYhmExdlg7gXEGezegtbNxBAob1qC2snEgY4x2LkCtA/AX5ADx+/I+5YUcvPmTyxVk+6L6zEzNp/6AMRGnyjpuES0eVu/kDc/LXafnimOT/I7IpXy21qwnR5wq4lQRp4o4VeENpest499ZT444VdZx4YGSb9bJGza3e5/vGZT15IhTZR0XHii/cK3z0d9hPTniVFnHTXagnLavQferHu0168kRp4o4VcSpIk5Vxn8ooohTRZwq4lQRp+oLpYMS+7GH5SUAAAAASUVORK5CYII=",ce="data:image/webp;base64,UklGRnIBAABXRUJQVlA4IGYBAADQCgCdASo3ADIAPmUqkEWkIqGb+1QAQAZEswBlGeFlV+Nwn59qdvtjedz/rv6k6zH6Ev7AdcJkSOO8KsfElJUhbP/yQdWz/e7HXClk8FB3Uqiu4dPO6zrd2gLymJiyAAD++faXh/4qfB7Z69thAb+V/ZZbADIBAAcmRT/SK4zOp+F8vH+WqJtBLfQx2bbAVLY+O2YSoEryUdaYAEyY0L6nHd7+Ga73IDS1Ba186QUZyiyEg/LvoAcZDbQsJZnS+3/Vssb77D0ompW4Sctx8n5PcVsVwyw3swZfmOyoDoWO+AWC2xNVNQpofllN2fpgYXlj+Xo3lhyx7uE/Z5yh9GnLXaJNL+UMxhe9CyA+gpoAnzT2r1jzGOCwiG+cL3+FnRRgnSczOZago3bJBwjfAiccHeYNI7bH+WdoxkpqGmClonsGkFhgmkAcFa1Xn0g60gGyJhcMYR4Eg2mxfoGfW+piQAAAAAAA",de="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M5%203h16v4h-2V5H5v14h14v-2h2v4H3V3h2zm16%208h-2V9h-2V7h-2v2h2v2H7v2h10v2h-2v2h2v-2h2v-2h2v-2z'%20fill='currentColor'/%3e%3c/svg%3e",ue="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M8%205v2h2V5H8zm4%204V7h-2v2h2zm2%202V9h-2v2h2zm0%202h2v-2h-2v2zm-2%202v-2h2v2h-2zm0%200h-2v2h2v-2zm-4%204v-2h2v2H8z'%20fill='currentColor'/%3e%3c/svg%3e",me="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M4%204h8v2h10v14H2V4h2zm16%204H10V6H4v12h16V8z'%20fill='currentColor'/%3e%3c/svg%3e",V=t=>{const s=o.useRef(null),d=o.useRef(null);return o.useEffect(()=>{if(t){d.current=document.activeElement;const l=s.current?.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');l&&l.length>0&&requestAnimationFrame(()=>{l[0].focus()})}return()=>{t&&d.current&&d.current.isConnected&&d.current.focus()}},[t]),{containerRef:s,handleKeyDown:l=>{if(!(!t||!s.current)&&l.key==="Tab"){const r=s.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!r.length)return;const A=r[0],_=r[r.length-1];l.shiftKey?document.activeElement===A&&(l.preventDefault(),_.focus()):document.activeElement===_&&(l.preventDefault(),A.focus())}}}},he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAUJJREFUeJzt3LFJBFEUQFFXzIw0swQjwQ7EQLADCxDjrWQLsIDNDAVFsAZzI2PBErSA+cGwV9SVc8LHwHwuDz4bzC4O948+d9jY7m8fYNsJGAkYCRjtjYZXq/ufP8kWWC8vJzMbGAkYCRgJGA0vkZHV9cGs55a3H+U83+ri7GUyO355n8zenl4ns7vTm1nvsIGRgJGAkYDR7EvkL10Ocz08n0xnowdPzzd+hw2MBIwEjASMhpfI3F8d/9nj89tkth48ZwMjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwGj4Rfro6+1GbOBkYCRgJGA0cJfwTc2MBIwEjASMPoCIOsbRX7fweMAAAAASUVORK5CYII=",we="data:image/svg+xml,%3csvg%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M20%203H2v14h8v2H8v2h8v-2h-2v-2h8V3h-2zm-6%2012H4V5h16v10h-6z'%20fill='currentColor'/%3e%3c/svg%3e",Ae=({onCancel:t})=>{const{t:s}=T(),{shutDownSystem:d,rebootSystem:u,returnToGame:l}=Q(),[r,A]=o.useState("shutdown"),{containerRef:_,handleKeyDown:v}=V(!0);o.useEffect(()=>{const w=g=>{g.key==="Escape"&&t()};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[t]);const f=()=>{switch(r){case"shutdown":d();break;case"restart":u();break;case"return_game":l();break}};return e.jsx("div",{className:"shutdown-dialog-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"shutdown-title",children:e.jsxs("div",{className:"shutdown-dialog",ref:_,onKeyDown:v,children:[e.jsxs("div",{className:"shutdown-dialog__header",children:[e.jsx("span",{id:"shutdown-title",className:"shutdown-dialog__title",children:s("shutdown_title")}),e.jsx("button",{className:"shutdown-dialog__close",onClick:t,"aria-label":s("close"),children:"Ã—"})]}),e.jsxs("div",{className:"shutdown-dialog__content",children:[e.jsx("div",{className:"shutdown-dialog__icon",children:e.jsx(z,{icon:we,size:32})}),e.jsxs("div",{className:"shutdown-dialog__options",children:[e.jsx("h3",{className:"shutdown-dialog__label",children:s("shutdown_question")}),e.jsxs("div",{className:"shutdown-dialog__radio-group",role:"radiogroup",children:[e.jsxs("label",{className:"shutdown-dialog__radio-option",children:[e.jsx("input",{type:"radio",name:"shutdown-option",value:"shutdown",checked:r==="shutdown",onChange:()=>A("shutdown"),className:"shutdown-dialog__radio-input"}),s("shutdown_computer")]}),e.jsxs("label",{className:"shutdown-dialog__radio-option",children:[e.jsx("input",{type:"radio",name:"shutdown-option",value:"restart",checked:r==="restart",onChange:()=>A("restart"),className:"shutdown-dialog__radio-input"}),s("restart_computer")]}),e.jsxs("label",{className:"shutdown-dialog__radio-option",children:[e.jsx("input",{type:"radio",name:"shutdown-option",value:"return_game",checked:r==="return_game",onChange:()=>A("return_game"),className:"shutdown-dialog__radio-input"}),s("return_to_game")]})]})]})]}),e.jsxs("div",{className:"shutdown-dialog__buttons",children:[e.jsx("button",{className:"shutdown-dialog__button",onClick:f,children:s("ok")}),e.jsx("button",{className:"shutdown-dialog__button",onClick:t,children:s("cancel")})]})]})})},pe=({onClose:t,apps:s})=>{const{t:d}=T(),{openWindow:u}=Q(),l=o.useRef(null),[r,A]=o.useState(null),[_,v]=o.useState(!1),f=o.useRef(null),{containerRef:w,handleKeyDown:g}=V(!_),i=n=>{if(g(n),n.key==="ArrowDown"||n.key==="ArrowUp"){n.preventDefault();const a=Array.from(l.current?.querySelectorAll('[role="menuitem"]')||[]);if(a.length===0)return;const c=a.indexOf(document.activeElement);let p=c;n.key==="ArrowDown"?p=(c+1)%a.length:p=(c-1+a.length)%a.length,a[p]?.focus()}n.key==="Escape"&&t()};o.useEffect(()=>{const n=a=>{if(!_&&w.current&&!w.current.contains(a.target)){if(document.getElementById("start-button")?.contains(a.target))return;t()}};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[t,w,_]);const m=n=>{u(n),t()},h=s.find(n=>n.id==="projects");return _?e.jsx(Ae,{onCancel:()=>v(!1)}):e.jsxs("div",{ref:w,className:"start-menu",onKeyDown:i,onContextMenu:n=>{n.preventDefault(),n.stopPropagation()},role:"menu","aria-label":d("start_menu"),children:[e.jsx("aside",{className:"start-menu__sidebar","aria-hidden":"true",children:e.jsxs("span",{className:"start-menu__sidebar-text",children:[e.jsx("span",{className:"start-menu__brand-name",children:"Windows"}),"95"]})}),e.jsxs("section",{className:"start-menu__content",children:[e.jsxs("div",{className:"start-menu__item-wrapper",onMouseEnter:()=>A("programs"),onMouseLeave:()=>A(null),role:"none",children:[e.jsxs(B,{ref:f,variant:"menu",role:"menuitem","aria-haspopup":"true","aria-expanded":r==="programs",className:"start-menu__item",onClick:()=>A(r==="programs"?null:"programs"),onKeyDown:n=>{(n.key==="ArrowRight"||n.key==="Enter"||n.key===" ")&&(A("programs"),n.preventDefault(),setTimeout(()=>{document.getElementById("submenu-programs-0")?.focus()},0))},children:[e.jsx(z,{icon:he,size:24,className:"start-menu__item-icon"}),e.jsx("span",{className:"start-menu__label",children:d("programs")}),e.jsx(z,{icon:ue,className:"start-menu__chevron"})]}),r==="programs"&&e.jsx("div",{className:"start-menu__submenu",role:"menu",children:s.filter(n=>n.visibility?.programs).map((n,a)=>e.jsxs(B,{id:`submenu-programs-${a}`,variant:"menu",onClick:()=>m(n),role:"menuitem",className:"start-menu__item",onKeyDown:c=>{c.key==="ArrowLeft"&&(A(null),c.preventDefault(),c.stopPropagation(),f.current?.focus())},children:[e.jsx(z,{icon:n.icon,size:24,className:"start-menu__item-icon"}),e.jsx("span",{className:"start-menu__label",children:n.title})]},n.id))})]}),e.jsxs(B,{variant:"menu",onClick:()=>h&&m(h),role:"menuitem",className:"start-menu__item",children:[e.jsx(z,{icon:h?.icon||me,size:24,className:"start-menu__item-icon"}),e.jsx("span",{className:"start-menu__label",children:d("projects")})]}),e.jsx("div",{className:"start-menu__divider"}),e.jsxs(B,{variant:"menu",onClick:()=>v(!0),role:"menuitem",className:"start-menu__item",children:[e.jsx(z,{icon:de,className:"start-menu__icon"}),e.jsx("span",{className:"start-menu__label",children:d("shutdown")})]})]})]})},fe=({availableApps:t})=>{const{t:s,language:d,setLanguage:u}=T(),{windows:l,activeWindowId:r,focusWindow:A,minimizeWindow:_}=Q(),[v,f]=o.useState(!1),[,w]=o.useState(new Date),[g,i]=o.useState(null),m=o.useRef(null),h=o.useRef(null),n=16,a=6,c=1600,p=()=>{u(d==="en"?"pt-BR":d==="pt-BR"?"es":"en")},E=s(d==="en"?"btn_to_pt":d==="pt-BR"?"btn_to_es":"btn_to_en");o.useEffect(()=>{const x=k=>{(k.key==="Meta"||k.ctrlKey&&k.key==="Escape")&&(k.preventDefault(),window.dispatchEvent(new CustomEvent("toggle-start-menu")))};window.addEventListener("keydown",x);const j=setInterval(()=>w(new Date),1e3);return()=>{window.removeEventListener("keydown",x),clearInterval(j)}},[]),o.useEffect(()=>{const x=j=>{h.current&&!h.current.contains(j.target)&&f(!1)};return v&&document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[v]),o.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]);const y=x=>{const j=l.find(k=>k.id===x);f(!1),r===x&&!j?.isMinimized?_(x):A(x)},S=x=>x.length>n?x.substring(0,n)+"...":x,D=x=>{m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{i(x)},c)},R=()=>{m.current&&(clearTimeout(m.current),m.current=null),i(null)},C=l.slice(0,a);return e.jsxs("footer",{className:"taskbar",role:"contentinfo","aria-label":s("taskbar_label")||"Taskbar",onContextMenu:x=>{x.preventDefault(),x.stopPropagation()},children:[e.jsxs("div",{className:"taskbar__start-menu-wrapper",ref:h,children:[v&&e.jsx("div",{className:"taskbar__start-popup",children:e.jsx(pe,{onClose:()=>f(!1),apps:t})}),e.jsxs(B,{id:"start-button",active:v,onClick:()=>f(!v),className:"taskbar__start-btn",variant:"taskbar","aria-haspopup":"true","aria-expanded":v,"aria-label":s("start_menu"),children:[e.jsxs("picture",{children:[e.jsx("source",{srcSet:ce,type:"image/webp"}),e.jsx("img",{src:le,alt:"",className:"taskbar__icon",onError:x=>{x.currentTarget.style.display="none"},"aria-hidden":"true",width:16,height:16})]}),e.jsx("span",{className:"taskbar__start-text",children:s("start")})]})]}),e.jsx("div",{className:"taskbar__divider"}),e.jsx("nav",{className:"taskbar__windows","aria-label":s("running_apps")||"Running applications",children:C.map(x=>{const j=x.title.length>n,k=r===x.id&&!x.isMinimized;return e.jsxs("div",{className:"taskbar__window-item",onMouseEnter:()=>D(x.id),onMouseLeave:R,onClick:R,children:[g===x.id&&j&&e.jsx("div",{className:"taskbar__tooltip",role:"tooltip",children:x.title}),e.jsxs(B,{active:k,onClick:()=>y(x.id),className:"taskbar__window-btn",variant:"taskbar","aria-label":`Switch to ${x.title}`,"aria-pressed":k,children:[e.jsx(z,{icon:x.icon,size:16,className:"taskbar__window-icon",alt:""}),e.jsx("span",{className:"taskbar__window-text",children:S(x.title)})]})]},x.id)})}),e.jsx("div",{className:"taskbar__divider"}),e.jsxs("div",{className:"taskbar__tray",children:[e.jsx("button",{onClick:p,className:"taskbar__language-btn",title:E,"aria-label":E,children:d==="en"?"ðŸ‡ºðŸ‡¸":d==="pt-BR"?"ðŸ‡§ðŸ‡·":"ðŸ‡ªðŸ‡¸"}),e.jsx(ae,{}),e.jsx(ie,{})]})]})},U=(t,s,d=0,u)=>{const[l,r]=o.useState(!1),[A,_]=o.useState(t),v=o.useRef({offset:{x:0,y:0},position:t,boundary:u,resetKey:d});o.useEffect(()=>{v.current.boundary=u},[u]),o.useEffect(()=>{_(t),v.current.position=t},[d]);const f=o.useCallback((i,m)=>{const h=v.current.position;v.current.offset={x:i-h.x,y:m-h.y},r(!0)},[]),w=o.useCallback(i=>{i.button===0&&(i.stopPropagation(),f(i.clientX,i.clientY))},[f]),g=o.useCallback(i=>{i.stopPropagation();const m=i.touches[0];f(m.clientX,m.clientY)},[f]);return o.useEffect(()=>{if(!l)return;const i=(a,c)=>{const{offset:p,boundary:E}=v.current;let y=a-p.x,S=c-p.y;if(E){const R=window.innerWidth-E.width,C=window.innerHeight-E.height-(E.bottomOffset??0),x=20;y<x&&(y=0),Math.abs(y-R)<x&&(y=R),S<x&&(S=0),Math.abs(S-C)<x&&(S=C),y=Math.max(0,Math.min(y,R)),S=Math.max(0,Math.min(S,C))}const D={x:y,y:S};_(D),v.current.position=D},m=a=>{a.preventDefault(),i(a.clientX,a.clientY)},h=a=>{a.cancelable&&a.preventDefault(),i(a.touches[0].clientX,a.touches[0].clientY)},n=()=>{r(!1),s(v.current.position)};return window.addEventListener("mousemove",m),window.addEventListener("mouseup",n),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",n),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",n),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",n)}},[l,s]),{position:A,handleMouseDown:w,handleTouchStart:g,isDragging:l}},ve={width:300,height:200},xe=(t,s,d,u,l,r,A=ve)=>{const[_,v]=o.useState(u),[f,w]=o.useState(!1),g=o.useRef(u),{width:i,height:m}=u;o.useEffect(()=>{f||v(n=>{if(n.width===i&&n.height===m)return n;const a={width:i,height:m};return g.current=a,a})},[i,m,f]);const h=o.useCallback(n=>{t&&(n.stopPropagation(),n.cancelable&&n.preventDefault(),w(!0))},[t]);return o.useEffect(()=>{if(!f||s)return;const n=(E,y)=>{const D=window.innerHeight-r,R=Math.min(y,D),C=E-d.x,x=R-d.y,j={width:Math.max(A.width,C),height:Math.max(A.height,x)};v(j),g.current=j},a=E=>{E.preventDefault(),n(E.clientX,E.clientY)},c=E=>{E.cancelable&&E.preventDefault(),n(E.touches[0].clientX,E.touches[0].clientY)},p=()=>{w(!1),l(g.current.width,g.current.height)};return window.addEventListener("mousemove",a),window.addEventListener("mouseup",p),window.addEventListener("touchmove",c,{passive:!1}),window.addEventListener("touchend",p),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",p),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",p)}},[f,s,d,r,l,A]),{size:_,isResizing:f,startResize:h}},ge=65,_e=({data:t})=>{const{focusWindow:s,updateWindowPosition:d,activeWindowId:u,closeWindow:l}=Q(),{t:r}=T(),A=o.useRef(null),_=u===t.id,v=`${t.id}-${t.isMaximized}-${t.size.width}-${t.size.height}`,{handleMouseDown:f,isDragging:w}=U(t.position,m=>d(t.id,m.x,m.y),v,{width:t.size.width,height:t.size.height,bottomOffset:ge}),g=()=>s(t.id),i={zIndex:t.zIndex,width:t.size.width,height:t.size.height,transform:`translate3d(${t.position.x}px, ${t.position.y}px, 0)`,position:"absolute",top:0,left:0,willChange:w?"transform":"auto"};return e.jsxs("div",{ref:A,style:i,onMouseDown:m=>{g(),f(m)},className:`window--assistant ${_?"window--active":""}`,role:"dialog","aria-modal":"false","aria-label":t.title,tabIndex:-1,children:[e.jsx("button",{className:"window__close-btn assistant-close-btn",onClick:m=>{m.stopPropagation(),l(t.id)},"aria-label":r("close_assistant"),children:e.jsx(z,{icon:ne,size:14,style:{filter:"invert(1)"}})}),e.jsx(o.Suspense,{fallback:e.jsx(Y,{}),children:t.component})]})},be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAG1JREFUWIXt1jEOQFAQRdEhOioVS7FVhe2wFAvQswAfxYv/X3FPOdXNJJNMBAAAAH5U9e14lo54U5cO+EKgyj6wSQ33Y81fEhFDN91m9hskUGUfmDySednylzyw3yCBKvtA3i0VgSoCVQSqCFRdVdwHnysZtIMAAAAASUVORK5CYII=",Ee="data:image/webp;base64,UklGRr4AAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSBMAAAABDzD/ERFCSED4f9oBekT/k5JvAFZQOCCEAAAAcAQAnQEqKAAoAD5tMJJGJCMhoS47+ACADYlnANHdO4UVYkXw0uP3OXQe8QAA/vvj9/j7Ztf8WdP/fD/be/+RX/9MNuR0xQKPtvF2JBr9g+/DtY/5v8ep8aX8PA1roCVgIqj56C/VslJvzI/lC//Ir/+gRIHAvwNyKINDbrT7oa8AAAAA",je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAK1JREFUWIVjZMAChLgl/2MTHwjANNAOIARGHUgpGPQOZCFWYdOkftq6hIGBoS6vEENs0IfgqAMpBYPegYwDVWtgy3SjmYQWYNSBlAKsNcmLL8epaokEjyXZegd9CI46kFIw6kBKwagDKQWjDqQUYK1JZs07QXOLsTWtsIFBH4KjDqQUDHoHDlifhFgw6ENw1IGUgkHvQKJHt6gN3n19zkiMukEfgqMOpBQMegcCADKnEx2VQATUAAAAAElFTkSuQmCC",ke="data:image/webp;base64,UklGRjABAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSB0AAAABDzD/ERFCTdtGUJmVP4syyXrvHtH/CQjAsP+tGgBWUDgg7AAAAJAGAJ0BKigAKAA+ZSiPRaQioRqkAEAGRLKAYV25HVfiAG0A1zMh38g02b7blfmYSsGWRD2OTaPkvIvhH0AA/urVtGD07WbcL/hC8jyF/2NWS1TjYkpK8F1yEOqLQLf4n+7lrbEepldUptPg5rx0Af5Svr/4TvSBqG4L1xM9jMG3TJYwEjnx9a42F/iqVu5dinvcxtlTIDmRQXv82SXprTBOLtnvsb8k5YirclEusnqmNhyDE3VibyNTPOEJFf/z3p6k6nRO7x7yM+9ojALDq24bJh86RwTv6dOvFb7r2mun16hLqFpPcQXHgAAA",ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAHRJREFUWIXt2KENgEAMQNE7ggOFglFYFcE6MAoD4GEAjiB+clT8L6te6to8dNOVAtf8DfhKIC08sC0Nj3OrL0kpjf38mIXfoECaQJpAmkCaQJpAmkCaQJpAWvEmWda9vuSl8BsUSAsPzH63YAJpAmkCaQJpN4BaB70DjgyYAAAAAElFTkSuQmCC",Ie="data:image/webp;base64,UklGRqwAAABXRUJQVlA4IKAAAAAwBQCdASooACgAPmUsj0WkIqEarqwAQAZEsYBmWqYPQSHG1uhnVYQBlM26MUDWZb3pqAD+/kfT/06vf/qv9+v/3//eGtAfV7jGKvopUCPPeCWeJsd+c/02ko3/v/y8PdF1k7RfhwK577ziNrdn2LWWkhXQDFTZqLY4QuF9KJRtYaVTlcAhNQrNxnkBHn4IEkmF+0Q4ArG1pztPhIAAAAAA",Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAKhJREFUWIXtmD0SQDAQhcXoqFQcxVUVrsNNqFTUHMAWK2+HV7yvzOTnm51ssklq6/4qMtnPNXn6IWuUuQO/QoIo9IKV1bgds2tw1wyuzf9ivkcbfQQliEIvmLynvHeje7ESwoI+ghJEoRc0y6XoxPEmhFW+0UdQgij0grpJUCSIQi9oJkn0DaE3yZ9IEMV8uI/TEroIMh99BCWIQi/oLrcs9AUswQDoBW+W6SxXuvoQ2QAAAABJRU5ErkJggg==",Ne="data:image/webp;base64,UklGRlYCAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSCMAAAABDzD/ERFCTdtGULeDXaqH5LLeByCi/xOAVTQdTCB6eNWqJgBWUDggDAIAABAOAJ0BKigAKAA+bSyTRyQiIaEqtVwAgA2JZQDM8PYIxLAE+S9USuL/p35IZ83GcPsg1iD/Dfkzrr/8B6e+h/6A/1XuD/xz+O/63+udlX0AAaWMe+gwliTxf5WCtjW0IfJQXNaQ/ur9eUdEZ7LOageiiaExhXD7/gAA/uqKrCDvX8PfXIHmXlU8bMnwDmJTb1IQah3xeI9Lnwb+Omn9Qhh7686Tw6REt+BCf9FxtkmwY+Put8tZBpxoQbojrCIMxwvYax+dNqyU+hRJl7THOfR2ardL8/QdV9PxwNHo/YxLv/5PneKe4Hv5xM211OIp8OcjJErtm9qso/yPnf9+ekEunOxb5as/1bErF76dHUulyMvYAXG4k0kkuamNWeSq/haOdripF1X5rTSKQRMJsVgLCW3bwvxTqPnhPJv2Um47v1zu0Qf/4bMl7SGPPwHD9WL3DR/Pvhr9wZdiEfqtDu6FR6T1BiJjw3Iq/HI3ZLnz7MYDZCqloLcKq7zZIrRr8QZBNSH///3URv/Hd6b+9d2If8qAoYm+S65ZPS6yEPGrvhynt+drlj3rYvGN9UqmiEv7g8kqhZQhxf5Zjgx22geyW3FSSUjWlYf398EAeiliDskVDmUdrnqor+IdH5MS9og79fq34VpTCQ0IOMGAKd6p5AzNBynWQbRId5UTz6ao54HBXh70gDIAAAAA",K=65,Me=({item:t,t:s,onAction:d,windowId:u,actions:l})=>{o.useEffect(()=>{const A=document.getElementById(`menu-${u}-${t}-0`);A&&A.focus()},[t,u]);const r=A=>{A.key==="Escape"&&d()};return e.jsxs(e.Fragment,{children:[t==="file"&&e.jsx("button",{id:`menu-${u}-${t}-0`,className:"window__menu-dropdown-item",role:"menuitem",onClick:A=>{A.stopPropagation(),l.close(),d()},onKeyDown:r,children:s("close")}),t==="view"&&e.jsx("button",{id:`menu-${u}-${t}-0`,className:"window__menu-dropdown-item",role:"menuitem",onClick:A=>{A.stopPropagation(),l.maximize(),d()},onKeyDown:r,children:l.isMaximized?s("restore"):s("maximize")}),t==="help"&&e.jsx("button",{id:`menu-${u}-${t}-0`,className:"window__menu-dropdown-item",role:"menuitem",onClick:A=>{A.stopPropagation(),alert(s("about_alert")),d()},onKeyDown:r,children:s("about")}),t==="edit"&&e.jsx("div",{className:"window__menu-dropdown-item disabled",style:{opacity:.5,cursor:"default"},children:s("no_actions")})]})},Ce=({data:t})=>{const{t:s}=T(),{closeWindow:d,minimizeWindow:u,maximizeWindow:l,focusWindow:r,updateWindowPosition:A,updateWindowSize:_,activeWindowId:v}=Q(),f=v===t.id,[w,g]=Z.useState(null);o.useEffect(()=>{const b=()=>g(null);return w&&window.addEventListener("click",b),()=>window.removeEventListener("click",b)},[w]);const{containerRef:i,handleKeyDown:m}=V(f),h=t.id.startsWith("assistant"),n=`${t.id}-${t.isMaximized}-${t.size.width}-${t.size.height}`,{position:a,handleMouseDown:c,handleTouchStart:p,isDragging:E}=U(t.position,b=>A(t.id,b.x,b.y),n,{width:t.size.width,height:t.size.height,bottomOffset:K}),{size:y,isResizing:S,startResize:D}=xe(f,t.isMaximized,a,t.size,(b,L)=>_(t.id,b,L),K,{width:300,height:300});o.useEffect(()=>{f&&i.current&&i.current.focus({preventScroll:!0})},[f,i]);const R=b=>{f&&m(b)};if(t.isMinimized)return null;const C=()=>r(t.id),x=t.isMaximized?"100%":y.width,j=t.isMaximized?`calc(100vh - ${K}px)`:y.height,k={zIndex:t.zIndex,width:x,height:j,transform:t.isMaximized?"none":`translate3d(${a.x}px, ${a.y}px, 0)`,position:t.isMaximized?"fixed":"absolute",top:0,left:0,willChange:E||S?"transform, width, height":"auto"};if(h)return e.jsx(_e,{data:t});const I=!["messenger","welcome","calculator","google"].some(b=>t.id.startsWith(b)),N=["file","edit","view","help"];return e.jsxs("div",{ref:i,style:k,onMouseDownCapture:C,onTouchStartCapture:C,onKeyDown:R,onContextMenu:b=>{b.preventDefault(),b.stopPropagation()},className:`window ${f?"window--active":"window--inactive"}`,role:"dialog","aria-labelledby":`window-title-${t.id}`,"aria-modal":f?"true":"false",tabIndex:-1,children:[e.jsxs("div",{className:`window__title-bar ${f?"window__title-bar--active":"window__title-bar--inactive"}`,onMouseDown:b=>!t.isMaximized&&c(b),onTouchStart:b=>!t.isMaximized&&p(b),onDoubleClick:()=>l(t.id),children:[e.jsxs("div",{className:"window__title-area",id:`window-title-${t.id}`,children:[e.jsx(z,{icon:t.icon,size:20}),e.jsx("span",{className:"window__title-text",children:t.title})]}),e.jsxs("div",{className:"window__actions",children:[e.jsx(B,{"aria-label":s("minimize"),onClick:()=>u(t.id),children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:Ee,type:"image/webp"}),e.jsx("img",{src:be,className:"window__action-icon",alt:""})]})}),e.jsx(B,{"aria-label":t.isMaximized?s("restore"):s("maximize"),onClick:()=>l(t.id),children:t.isMaximized?e.jsxs("picture",{children:[e.jsx("source",{srcSet:ke,type:"image/webp"}),e.jsx("img",{src:je,className:"window__action-icon",alt:""})]}):e.jsxs("picture",{children:[e.jsx("source",{srcSet:Ie,type:"image/webp"}),e.jsx("img",{src:ye,className:"window__action-icon",alt:""})]})}),e.jsx(B,{"aria-label":s("close"),onClick:()=>d(t.id),children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:Ne,type:"image/webp"}),e.jsx("img",{src:Se,className:"window__action-icon",alt:""})]})})]})]}),I&&e.jsx("div",{className:"window__menu",role:"menubar",children:N.map(b=>e.jsxs("div",{style:{position:"relative"},role:"none",children:[e.jsx("button",{className:`window__menu-item ${w===b?"window__menu-item--active":""}`,role:"menuitem","aria-haspopup":"true","aria-expanded":w===b,onClick:L=>{L.stopPropagation(),g(w===b?null:b)},onMouseEnter:()=>{w&&g(b)},onKeyDown:L=>{L.key==="ArrowDown"&&w===b&&(document.getElementById(`menu-${t.id}-${b}-0`)?.focus(),L.preventDefault()),L.key==="ArrowDown"&&!w&&(g(b),L.preventDefault())},children:s(b)}),w===b&&e.jsx("div",{className:"window__menu-dropdown",role:"menu",onMouseLeave:()=>g(null),children:e.jsx(Me,{item:b,t:s,onAction:()=>g(null),windowId:t.id,actions:{close:()=>d(t.id),maximize:()=>l(t.id),isMaximized:t.isMaximized}})})]},b))}),e.jsxs("div",{className:"window__content",children:[e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"window__loading",children:e.jsx(Y,{})}),children:t.component}),!f&&e.jsx("div",{className:"window__overlay"})]}),!t.isMaximized&&e.jsx("div",{className:"window__resize-handle",onMouseDown:D,onTouchStart:D,"aria-hidden":"true",title:s("window_resize"),children:e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 12 12",className:"window__resize-icon",children:[e.jsx("path",{d:"M8 11H11V8",stroke:"gray",fill:"none"}),e.jsx("path",{d:"M4 11H7V11",stroke:"gray",fill:"none"}),e.jsx("path",{d:"M11 7V4",stroke:"gray",fill:"none"})]})})]})},X=o.forwardRef(({app:t,initialPosition:s,onDragEnd:d,onSelect:u,isSelected:l,resetKey:r,tabIndex:A=0},_)=>{const v=o.useMemo(()=>({width:100,height:128,bottomOffset:50}),[]),{position:f,handleMouseDown:w,handleTouchStart:g,isDragging:i}=U(s,h=>d(t.id,h.x,h.y),r,v),m=h=>{h.stopPropagation();const n=h.ctrlKey||h.metaKey||h.shiftKey;u(t.id,n)};return e.jsxs("button",{ref:_,type:"button",className:`desktop-icon ${l?"desktop-icon--selected":""} ${i?"desktop-icon--dragging":""}`,style:{transform:`translate3d(${f.x}px, ${f.y}px, 0)`},onMouseDown:h=>{m(h),w(h)},onClick:m,onKeyDown:h=>{if(h.key==="Enter"){h.preventDefault(),h.stopPropagation(),u(t.id,!1);const n=new MouseEvent("dblclick",{bubbles:!0,cancelable:!0,view:window});h.currentTarget.dispatchEvent(n)}},onTouchStart:g,onContextMenu:h=>{h.preventDefault(),h.stopPropagation()},"aria-label":t.title,"aria-pressed":l,tabIndex:A,children:[e.jsx("div",{className:"desktop-icon__img-wrapper",children:e.jsx(z,{icon:t.icon,size:64,className:"desktop-icon__img",alt:""})}),e.jsx("div",{className:"desktop-icon__label",children:e.jsx("span",{className:"desktop-icon__text",children:t.title})})]})});X.displayName="DesktopIcon";const De=({onReboot:t})=>{const s=o.useRef(null),{t:d}=T(),{playSound:u}=G();return o.useEffect(()=>{u("error"),s.current?.focus();const l=r=>{r?.preventDefault(),t()};return window.addEventListener("keydown",l),window.addEventListener("click",l),window.addEventListener("touchstart",l),window.addEventListener("pointerdown",l),()=>{window.removeEventListener("keydown",l),window.removeEventListener("click",l),window.removeEventListener("touchstart",l),window.removeEventListener("pointerdown",l)}},[t,u]),e.jsx("div",{ref:s,tabIndex:-1,className:"blue-screen",children:e.jsxs("div",{className:"blue-screen__content",children:[e.jsx("p",{className:"blue-screen__title",children:d("blue_screen_windows")}),e.jsx("p",{className:"blue-screen__message",children:d("blue_screen_fatal_exception")}),e.jsxs("ul",{className:"blue-screen__list",children:[e.jsx("li",{children:d("blue_screen_terminate")}),e.jsx("li",{children:d("blue_screen_ctrl_alt_del")})]}),e.jsx("p",{className:"blue-screen__prompt",children:d("blue_screen_press_any_key")})]})})},M={W:100,H:128,OFFSET_X:10,OFFSET_Y:10},Re=50,Le=t=>{const{getItemsInFolder:s}=$(),[d,u]=o.useState(0),[l,r]=o.useState(()=>{try{const i=localStorage.getItem("OS_ICON_POSITIONS");return i?JSON.parse(i):{}}catch{return{}}});o.useEffect(()=>{localStorage.setItem("OS_ICON_POSITIONS",JSON.stringify(l))},[l]);const A=o.useMemo(()=>{const m=s("desktop").filter(n=>n.id!=="recycle_bin").map(n=>{let a=oe;if(n.type==="folder")a=ee;else if(n.appId){const c=t.find(p=>p.id===n.appId);c&&(a=c.icon)}else a=te;return{id:`fs:${n.id}`,title:n.name,icon:a,appId:n.appId||"notepad",fsId:n.id,type:n.type,isSystemApp:!1,content:n.content}});return[...t.filter(n=>n.visibility?.desktop).map(n=>({id:`app:${n.id}`,title:n.title,icon:n.icon,appId:n.id,type:"app",isSystemApp:!0})),...m].sort((n,a)=>n.title.localeCompare(a.title))},[s,t]),_=o.useMemo(()=>{if(typeof window>"u")return{maxRows:6,maxCols:10};const i=window.innerHeight,m=window.innerWidth,h=i-Re-M.OFFSET_Y,n=m-M.OFFSET_X,a=Math.max(1,Math.floor(h/M.H)),c=Math.max(1,Math.floor(n/M.W));return{maxRows:a,maxCols:c}},[d]),v=o.useCallback((i,m,h,n)=>Object.entries(h).some(([a,c])=>a===n?!1:c.col===i&&c.row===m),[]),f=o.useMemo(()=>{const i={...l},{maxRows:m,maxCols:h}=_,n=h<=4,a=()=>{let c=0,p=0,E=0;const y=m*h+500;if(n)for(;v(c,p,i)&&E<y;)c++,c>=h&&(c=0,p++),E++;else for(;v(c,p,i)&&E<y;)p++,p>=m&&(p=0,c++),E++;return{col:c,row:p}};return A.forEach(c=>{const p=i[c.id];if(!(p&&(n?!0:p.row<m)&&p.col<h)){const y=a();i[c.id]=y}}),i},[A,l,v,_]),w=o.useCallback((i,m,h)=>{const{maxRows:n,maxCols:a}=_,c=Math.round((m-M.OFFSET_X)/M.W),p=Math.round((h-M.OFFSET_Y)/M.H);u(E=>E+1),!(p<0||p>=n||c<0||c>=a)&&(v(c,p,f,i)||r(E=>({...E,[i]:{col:c,row:p}})))},[f,v,_]),g=o.useCallback(()=>{const{maxRows:i}=_,m={};let h=0,n=0;[...A].sort((c,p)=>c.title.localeCompare(p.title)).forEach(c=>{m[c.id]={col:h,row:n},n++,n>=i&&(n=0,h++)}),r(m),u(c=>c+1)},[A,_]);return o.useEffect(()=>{const i=()=>u(m=>m+1);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),{displayItems:A,computedPositions:f,handleDragEnd:w,setIconPositions:r,setDragVersion:u,dragVersion:d,arrangeIcons:g}},ze=(t,s,d)=>{const[u,l]=o.useState([]),[r,A]=o.useState(null),_=o.useCallback(w=>{w.button!==2&&w.target===d.current&&(A({start:{x:w.clientX,y:w.clientY},current:{x:w.clientX,y:w.clientY}}),w.ctrlKey||l([]))},[d]);o.useEffect(()=>{if(!r)return;const w=i=>A(m=>m?{...m,current:{x:i.clientX,y:i.clientY}}:null),g=()=>A(null);return window.addEventListener("mousemove",w),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",g)}},[r]),o.useEffect(()=>{if(!r)return;const w=Math.min(r.start.x,r.current.x),g=Math.min(r.start.y,r.current.y),i=Math.max(r.start.x,r.current.x),m=Math.max(r.start.y,r.current.y),h=[];t.forEach(a=>{const c=s[a.id];if(!c)return;const p=M.OFFSET_X+c.col*M.W,E=M.OFFSET_Y+c.row*M.H;w<p+M.W&&i>p&&g<E+M.H&&m>E&&h.push(a.id)});const n=setTimeout(()=>l(h),0);return()=>clearTimeout(n)},[r,s,t]);const v=o.useCallback(w=>{const g=u[0];if(!g&&t.length>0){l([t[0].id]);return}const i=s[g];if(!i)return;let m=null,h=1/0;Object.entries(s).forEach(([n,a])=>{if(n===g)return;let c=!1,p=1/0;switch(w){case"ArrowRight":a.row===i.row&&a.col>i.col&&(c=!0,p=a.col-i.col);break;case"ArrowLeft":a.row===i.row&&a.col<i.col&&(c=!0,p=i.col-a.col);break;case"ArrowDown":a.col===i.col&&a.row>i.row&&(c=!0,p=a.row-i.row);break;case"ArrowUp":a.col===i.col&&a.row<i.row&&(c=!0,p=i.row-a.row);break}c&&p<h&&(h=p,m=n)}),m&&l([m])},[u,s,t]),f=o.useCallback(w=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),v(w.key))},[v]);return{selectedIconIds:u,setSelectedIconIds:l,selectionBox:r,handleMouseDown:_,handleKeyDown:f}},Te=t=>{const{onCloseWindow:s,onToggleStartMenu:d,onEscape:u}=t;o.useEffect(()=>{const l=r=>{if(r.altKey&&r.key==="F4"){r.preventDefault(),s?.();return}if((r.metaKey||r.key==="Meta"||r.key==="OS")&&!r.ctrlKey&&!r.altKey){r.preventDefault(),d?.();return}if(r.key==="Escape"){u?.();return}};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}},[s,d,u])},Be=()=>{const{t}=T(),[s,d]=o.useState(null),[u,l]=o.useState(!1);o.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches||localStorage.getItem("pwa-install-dismissed")==="true")return;const w=g=>{g.preventDefault(),d(g),setTimeout(()=>{l(!0)},3e4)};return window.addEventListener("beforeinstallprompt",w),()=>{window.removeEventListener("beforeinstallprompt",w)}},[]);const r=async()=>{if(!s)return;await s.prompt();const{outcome:v}=await s.userChoice;console.log(v==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),d(null),l(!1)},A=()=>{l(!1),localStorage.setItem("pwa-install-dismissed","true")},_=()=>{l(!1)};return!u||!s?null:e.jsxs("div",{className:"install-prompt",role:"dialog","aria-labelledby":"install-title","aria-describedby":"install-message",children:[e.jsxs("div",{className:"install-prompt__title-bar",children:[e.jsxs("div",{className:"install-prompt__title",id:"install-title",children:[e.jsx("svg",{className:"install-prompt__icon",viewBox:"0 0 16 16",fill:"currentColor",children:e.jsx("path",{d:"M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"})}),t("pwa_install_title")]}),e.jsx("button",{className:"install-prompt__close",onClick:A,"aria-label":t("pwa_install_close"),children:"Ã—"})]}),e.jsxs("div",{className:"install-prompt__content",children:[e.jsxs("div",{className:"install-prompt__message",id:"install-message",children:[e.jsxs("svg",{className:"install-prompt__info-icon",viewBox:"0 0 32 32",fill:"none",children:[e.jsx("circle",{cx:"16",cy:"16",r:"15",stroke:"#0000AA",strokeWidth:"2",fill:"#00AAFF"}),e.jsx("text",{x:"16",y:"22",fontSize:"18",fontWeight:"bold",textAnchor:"middle",fill:"white",children:"i"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:"8px",fontWeight:"bold"},children:t("pwa_install_message_bold")}),e.jsx("p",{style:{fontSize:"14px"},children:t("pwa_install_message_description")})]})]}),e.jsxs("div",{className:"install-prompt__buttons",children:[e.jsx("button",{className:"install-prompt__button",onClick:_,children:t("pwa_install_later")}),e.jsx("button",{className:"install-prompt__button install-prompt__button--primary",onClick:r,children:t("pwa_install_button")})]})]})]})},F={W:100,H:128,OFFSET_X:10,OFFSET_Y:10},Pe=({apps:t=[]})=>{const{t:s}=T(),{windows:d,openWindow:u,isCrashed:l,isShutDown:r,rebootSystem:A}=Q(),_=o.useRef(null),v=o.useRef({}),f=o.useRef({id:"",time:0}),{displayItems:w,computedPositions:g,handleDragEnd:i,dragVersion:m,arrangeIcons:h}=Le(t),{selectedIconIds:n,setSelectedIconIds:a,selectionBox:c}=ze(w,g,_),[p,E]=o.useState(null),{containerRef:y,handleKeyDown:S}=V(!!p);o.useEffect(()=>{if(n.length===1){const j=n[0],k=v.current[j];k&&k.focus()}},[n]);const{activeWindowId:D,closeWindow:R}=Q();Te({onCloseWindow:()=>{D&&R(D)},onEscape:()=>{E(null),a([]),_.current?.focus()}});const C=o.useRef(!1);o.useEffect(()=>{if(C.current)return;if(C.current=!0,!localStorage.getItem("portfolio_visited")){localStorage.setItem("portfolio_visited","true");const k=t.find(b=>b.id===H.WELCOME),W=t.find(b=>b.id===H.ASSISTANT),I=t.find(b=>b.id===H.GOOGLE),N=[];return k&&N.push(setTimeout(()=>u(k),500)),I&&N.push(setTimeout(()=>u(I),1e3)),W&&N.push(setTimeout(()=>u(W),2e3)),()=>{N.forEach(clearTimeout)}}},[t,u]);const x=o.useCallback(j=>{const k=w.find(I=>I.id===j);if(!k)return;if(k.isSystemApp){const I=t.find(N=>N.id===k.appId);I&&u(I);return}if(k.type==="folder"){const I=t.find(N=>N.id==="computer")||t.find(N=>N.id==="documents");I&&u(I,{folderId:k.fsId});return}const W=t.find(I=>I.id===k.appId);W&&u(W,{content:k.content,title:k.title})},[w,t,u]);return l?e.jsx(De,{onReboot:A}):r?e.jsx(se,{onReboot:A}):e.jsxs("main",{className:"desktop",children:[e.jsx("a",{href:"#desktop-icons",className:"desktop__skip-link",children:s("skip_to_content")}),e.jsx("div",{id:"desktop-nav-hint",className:"sr-only",style:{position:"absolute",width:"1px",height:"1px",overflow:"hidden",clip:"rect(0,0,0,0)"},children:s("desktop_nav_hint")}),e.jsxs("div",{ref:_,id:"desktop-icons",className:"desktop__inner",children:[e.jsx("div",{className:"desktop__icons-layer",children:w.map(j=>{const k=g[j.id];if(!k)return null;const W={id:j.id,title:j.title,icon:j.icon,component:()=>null},I=n.includes(j.id),N=n.length>0?I&&n[0]===j.id:!1,b=w[0]?.id===j.id,L=N||n.length===0&&b?0:-1;return e.jsx(X,{ref:O=>{v.current[j.id]=O},app:W,isSelected:I,tabIndex:L,"aria-describedby":"desktop-nav-hint",initialPosition:{x:F.OFFSET_X+k.col*F.W,y:F.OFFSET_Y+k.row*F.H},onDragEnd:i,resetKey:m,onSelect:(O,J)=>{const P=Date.now();f.current.id===O&&P-f.current.time<500?(x(O),f.current={id:"",time:0}):f.current={id:O,time:P},a(q=>J?Array.from(new Set([...q,O])):[O])}},j.id)})}),c&&e.jsx("div",{className:"desktop__selection-box",style:{left:Math.min(c.start.x,c.current.x),top:Math.min(c.start.y,c.current.y),width:Math.abs(c.current.x-c.start.x),height:Math.abs(c.current.y-c.start.y)}}),p&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"desktop__context-menu-overlay",onClick:()=>E(null),onContextMenu:j=>j.preventDefault(),"aria-label":s("close_button"),type:"button"}),e.jsxs("div",{ref:y,className:"desktop__context-menu",style:{left:p.x,top:p.y},role:"menu","aria-label":s("desktop_context_menu"),onKeyDown:j=>{S(j),j.key==="Escape"&&E(null)},children:[e.jsx("button",{className:"desktop__context-menu-item",role:"menuitem",tabIndex:0,onClick:()=>{h(),E(null)},children:s("arrange_icons")}),e.jsx("div",{className:"desktop__context-menu-separator"})]})]}),d.map(j=>e.jsx(Ce,{data:j},j.id)),e.jsx("div",{className:"desktop__taskbar-layer",children:e.jsx(fe,{availableApps:t})})]}),e.jsx(Be,{})]})};export{Pe as Desktop};
